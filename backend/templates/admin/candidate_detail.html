{% extends 'admin/base.html' %}

{% block title %}Candidate Details{% endblock %}

{% block page_title %}Candidate Details{% endblock %}

{% block content %}
<div class="table-container">
    <div class="table-header">
        <h2>{{ candidate.full_name }}</h2>
        <a href="{% url 'admin_candidates' %}" class="filter-btn">
            ‚Üê Back to Candidates
        </a>
    </div>

    <form method="post" enctype="multipart/form-data" style="margin-top: 2rem;">
        {% csrf_token %}
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
            <!-- Left Column -->
            <div>
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; font-weight: 600; color: #2c3e50; margin-bottom: 0.5rem;">
                        Full Name <span style="color: #e74c3c;">*</span>
                    </label>
                    <input type="text" 
                           name="full_name" 
                           value="{{ candidate.full_name }}" 
                           required
                           style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; font-size: 0.95rem;">
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; font-weight: 600; color: #2c3e50; margin-bottom: 0.5rem;">
                        Email Address <span style="color: #e74c3c;">*</span>
                    </label>
                    <input type="email" 
                           name="email" 
                           value="{{ candidate.email }}" 
                           required
                           style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; font-size: 0.95rem;">
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; font-weight: 600; color: #2c3e50; margin-bottom: 0.5rem;">
                        Gender <span style="color: #e74c3c;">*</span>
                    </label>
                    <select name="gender" 
                            required
                            style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; font-size: 0.95rem;">
                        <option value="Male" {% if candidate.gender == 'Male' %}selected{% endif %}>Male</option>
                        <option value="Female" {% if candidate.gender == 'Female' %}selected{% endif %}>Female</option>
                    </select>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; font-weight: 600; color: #2c3e50; margin-bottom: 0.5rem;">
                        Designation <span style="color: #e74c3c;">*</span>
                    </label>
                    <input type="text" 
                           name="designation" 
                           value="{{ candidate.designation }}" 
                           required
                           style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; font-size: 0.95rem;">
                </div>
            </div>

            <!-- Right Column -->
            <div>
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; font-weight: 600; color: #2c3e50; margin-bottom: 0.5rem;">
                        Workplace Address <span style="color: #e74c3c;">*</span>
                    </label>
                    <textarea name="workplace_address" 
                              rows="3"
                              required
                              style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; font-size: 0.95rem;">{{ candidate.workplace_address }}</textarea>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; font-weight: 600; color: #2c3e50; margin-bottom: 0.5rem;">
                        Desired Position
                    </label>
                    <input type="text" 
                           value="{{ candidate.desired_position.name }}" 
                           readonly
                           style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; background-color: #e5e7eb; font-size: 0.95rem; color: #6b7280;">
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; font-weight: 600; color: #2c3e50; margin-bottom: 0.5rem;">
                        Total Votes
                    </label>
                    <input type="text" 
                           value="{{ vote_count }}" 
                           readonly
                           style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 4px; background-color: #e5e7eb; font-size: 0.95rem; color: #6b7280;">
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <label style="display: flex; align-items: center; gap: 0.75rem; font-weight: 600; color: #2c3e50;">
                        <input type="checkbox" 
                               name="approved" 
                               {% if candidate.approved %}checked{% endif %}
                               style="width: 20px; height: 20px; cursor: pointer; accent-color: #10b981;">
                        <span>Approved</span>
                    </label>
                    <small style="color: #6b7280; display: block; margin-top: 0.5rem;">
                        Check this box to approve the candidate for voting
                    </small>
                </div>
            </div>
        </div>

        <!-- Photo Section -->
        <div style="margin-bottom: 2rem; padding: 1.5rem; background: #f9fafb; border-radius: 8px;">
            <label style="display: block; font-weight: 600; color: #2c3e50; margin-bottom: 1rem;">
                Candidate Photo
            </label>
            
            {% if candidate.photo %}
            <div style="margin-bottom: 1rem;">
                <img src="{{ candidate.photo.url }}" 
                     alt="{{ candidate.full_name }}" 
                     style="width: 150px; height: 150px; border-radius: 8px; object-fit: cover; border: 3px solid #e0e0e0;">
            </div>
            {% endif %}
            
            <input type="file" 
                   name="photo" 
                   accept="image/jpeg,image/jpg,image/png"
                   style="padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 4px; background-color: white; font-size: 0.95rem;">
            <small style="color: #6b7280; display: block; margin-top: 0.5rem;">
                Upload a new photo to replace the current one (JPG, JPEG, PNG only)
            </small>
        </div>

        <!-- Action Buttons -->
        <div style="display: flex; gap: 1rem; padding-top: 1.5rem; border-top: 1px solid #e5e7eb;">
            <button type="submit" class="details-btn">
                Save Changes
            </button>
            
            <a href="{% url 'admin_candidates' %}" 
               class="details-btn" 
               style="background: #6b7280; text-decoration: none;">
                Cancel
            </a>
        </div>
    </form>
</div>

<!-- Display Messages -->
{% if messages %}
<div style="position: fixed; top: 2rem; right: 2rem; z-index: 9999;">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}" style="margin-bottom: 1rem; min-width: 300px;">
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}

{% block extra_css %}
<style>
    @media (max-width: 768px) {
        form > div:first-child {
            grid-template-columns: 1fr !important;
        }
    }
</style>
{% endblock %}
{% endblock %}